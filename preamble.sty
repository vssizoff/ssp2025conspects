\ProvidesPackage{preamble}

% Корректность отображения всех шрифтов, кодировок и мат. символов
% \usepackage[T2A]{fontenc}
% \usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{amssymb, amsmath, amsthm, mathtools}

% Отображение содержания
\usepackage{tocloft}
\addto\captionsrussian{\renewcommand*{\contentsname}{Оглавление}}
% \renewcommand{\cftsecfont}{\mdseries}
% \renewcommand{\cftsecpagefont}{\mdseries}

% Настройки шрифта
\usepackage{fontspec}
\setmainfont{CMU Serif}
\setsansfont{CMU Sans Serif}
\setmonofont{CMU Typewriter Text}

% Отступ у первого абзаца
\usepackage{indentfirst}

% Вставка картинок
\usepackage{graphicx}
\graphicspath{img/}

% Minted для кода
\usepackage{minted}

% Для иллюстраций
\usepackage{asymptote}
\usepackage{tikz}
\usetikzlibrary {positioning,graphs,calc,decorations.pathmorphing,shapes,arrows.meta,arrows,shapes.misc,fit}

% Огибание картинок текстом
\usepackage{wrapfig}

% Римские числа из арабских
\newcommand{\rnum}[1]{\uppercase\expandafter{\romannumeral #1\relax}}

% Гиперссылки
\usepackage{hyperref}

% Цвета
\usepackage{xcolor, colortbl}
\definecolor{lightgray}{gray}{0.7}

% Работа с таблицами
\usepackage{array}
\newcommand{\PreserveBackslash}[1]{\let\temp=\\#1\let\\=\temp}
\newcolumntype{C}[1]{>{\PreserveBackslash\centering}p{#1}}
\newcolumntype{R}[1]{>{\PreserveBackslash\raggedleft}p{#1}}
\newcolumntype{L}[1]{>{\PreserveBackslash\raggedright}p{#1}}

% Часто используемые обозначения
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\K}{\mathbb{K}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\A}{\mathcal{A}}
\newcommand{\B}{\mathcal{B}}
\newcommand{\ds}{\displaystyle}
\newcommand{\id}{\operatorname{id}}
\newcommand{\rk}{\operatorname{rk}}
\newcommand{\tr}{\operatorname{tr}}
\newcommand{\sgn}{\operatorname{sgn}}
\newcommand{\dist}{\operatorname{dist}}
\newcommand{\diam}{\operatorname{diam}}
\newcommand{\rev}{\operatorname{rev}}
\newcommand{\codim}{\operatorname{codim}}
\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}
\newcommand{\BV}{\operatorname{BV}}
\newcommand{\Ker}{\operatorname{Ker}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\Mat}{\operatorname{Mat}}
\newcommand{\ord}{\operatorname{ord}}
\newcommand{\inter}{\operatorname{int}}
\newcommand{\ext}{\operatorname{ext}}
\newcommand{\layer}{\operatorname{layer}}
\renewcommand{\gcd}{\operatorname{НОД}}
\newcommand{\lcm}{\operatorname{НОК}}
\newcommand{\ot}{\leftarrow}
\newcommand{\bs}[1]{\boldsymbol{#1}}
\newcommand{\abs}[1]{\left\lvert#1\right\rvert}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\br}[1]{\left(#1\right)}
\newcommand{\sqbr}[1]{\left[#1\right]}
\newcommand{\ddfrac}[2]{\frac{\ds #1}{\ds #2}}
\DeclareMathOperator*{\lowint}{\underline{\int}}
\DeclareMathOperator*{\upint}{\overline{\int}}
\DeclareMathOperator*{\V}{V}
\newcommand\bigzero{\scalebox{2}{$0$}}

% Перенос символа на следующую строку в формулах
\newcommand*{\hm}[1]{#1\nobreak\discretionary{}%
 {\hbox{$\mathsurround=0pt #1$}}{}}

% Отступы между абзацами
\setlength{\parskip}{.5ex}

% Отступы
\usepackage[left=15mm,right=15mm,top=10mm,bottom=20mm]{geometry}

% Для работы со списками
\usepackage{enumitem}

% Настройка межстрочных интервалов
\usepackage{setspace}

% Оболочка для теоремы
\newcounter{theorem}[section]
\newenvironment{theorem}[1][]{\par\smallskip
\refstepcounter{theorem}
    \ifx&#1&
        \smallskip\noindent{\bfseries Теорема \thetheorem.}
    \else
        \smallskip\noindent{\bfseries Теорема \thetheorem\;{\mdseries(#1)}.}
    \fi
    }{
    \par\smallskip
}

% Оболочка для алгоритма
\newenvironment{algorithm}[1][]{\par\smallskip
    \ifx&#1&
        \smallskip\noindent{\bfseries Алгоритм.}
    \else
        \smallskip\noindent{\bfseries Алгоритм #1.}
    \fi
    }{
    \par\smallskip
}

% Оболочка для доказательства
\renewenvironment{proof}{\smallskip
    \noindent{\bfseries Доказательство.}
}{
    \hfill$\blacksquare$\par\smallskip
}

% Оболочка для решения
\newenvironment{solution}{\smallskip
    \noindent$\vartriangleright$
}{
    \hfill$\blacktriangleleft$\par\smallskip
}

% Оболочки для леммы, предложения и утверждения
\newcounter{lemma}[section]
\newenvironment{lemma}[1][]{\par\smallskip
\refstepcounter{lemma}
    \ifx&#1&
        \smallskip\noindent{\bfseries Лемма \thelemma.}
    \else
        \smallskip\noindent{\bfseries Лемма \thelemma\;{\mdseries(#1)}.}
    \fi
    }{
    \par\smallskip
}

\newcounter{proposal}[section]
\newenvironment{proposal}[1][]{\par\smallskip
\refstepcounter{proposal}
    \ifx&#1&
        \smallskip\noindent{\bfseries Предложение \theproposal.}
    \else
        \smallskip\noindent{\bfseries Предложение \theproposal\;{\mdseries(#1)}.}
    \fi
    }{
    \par\smallskip
}

\newcounter{statement}[section]
\newenvironment{statement}[1][]{\par\smallskip
\refstepcounter{statement}
    \ifx&#1&
        \smallskip\noindent{\bfseries Утверждение \thestatement.}
    \else
        \smallskip\noindent{\bfseries Утверждение \thestatement\;{\mdseries(#1)}.}
    \fi
    }{
    \par\smallskip
}

% Оболочка для определения
\newcounter{definition}[section]
\newenvironment{definition}[1][]{\par\smallskip
\refstepcounter{definition}
    \ifx&#1&
        \smallskip\noindent{\bfseries Определение \thedefinition.}
    \else
        \smallskip\noindent{\bfseries Определение \thedefinition\;{\mdseries(#1)}.}
    \fi
    }{
    \par\smallskip
}

% Оболочка для примечания
\newenvironment{remark}[1][]{\par\smallskip
    \ifx&#1&
        \smallskip\noindent{\bfseries Примечание.}
    \else
        \smallskip\noindent{\bfseries Примечание\;(#1).}
    \fi
    }{
    \par\smallskip
}

% Оболочка для следствия
\newcounter{corollary}[theorem]
\newenvironment{corollary}[1][]{\par\smallskip
\refstepcounter{corollary}
    \ifx&#1&
        \smallskip\noindent{\bfseries Следствие \thecorollary.}
    \else
        \smallskip\noindent{\bfseries Следствие \thecorollary\;{\mdseries(#1)}.}
    \fi
    }{
\par\smallskip
}

% Оболочка для упражнения
\newcounter{exercise}[section]
\newenvironment{exercise}[1][]{\par\smallskip
\refstepcounter{exercise}
    \ifx&#1&
        \smallskip\noindent{\bfseries Упражнение \theexercise.}
    \else
        \smallskip\noindent{\bfseries Упражнение \theexercise\;{\mdseries(#1)}.}
    \fi
    }{
    \par\smallskip
}

% Оболочка для примера
\newcounter{example}[section]
\newenvironment{example}[1][]{\par\smallskip
\refstepcounter{example}
    \ifx&#1&
        \smallskip\noindent{\bfseries Пример \theexample.}
    \else
        \smallskip\noindent{\bfseries Пример \theexample\;{\mdseries(#1)}.}
    \fi
    }{
    \par\smallskip
}

% Оболочка для задачи
\newcounter{problem}[section]
\newenvironment{problem}[1][]{\par\smallskip
\refstepcounter{problem}
    \ifx&#1&
        \smallskip\noindent{\bfseries Задача \theproblem.}
    \else
        \smallskip\noindent{\bfseries Задача \theproblem\;{\mdseries(#1)}.}
    \fi
    }{
    \par\smallskip
}

